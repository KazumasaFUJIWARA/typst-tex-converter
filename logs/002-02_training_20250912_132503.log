Llama 3.2 3Bモデル: meta-llama/Llama-3.2-3B-Instruct
データ: ../jsonl/train_002.jsonl
出力: ../outputs/llama32-3b-typst-qlora-002-02
学習率: 0.0001
エポック数: 1
バッチサイズ: 2
勾配累積: 8
LoRA rank: 8
LoRA alpha: 16
LoRA dropout: 0.1
==================================================
トークナイザーを読み込み中...
4bit量子化設定を準備中...
モデルを読み込み中...

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.94s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.60s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.80s/it]
/mnt/d/github/typst-tex-converter/venv/lib/python3.11/site-packages/peft/tuners/lora/bnb.py:348: UserWarning: Merge lora module to 4-bit linear may get different generations due to rounding errors.
  warnings.warn(
/mnt/d/github/typst-tex-converter/venv/lib/python3.11/site-packages/peft/tuners/tuners_utils.py:196: UserWarning: Already found a `peft_config` attribute in the model. This will lead to having multiple adapters in the model. Make sure to know what you are doing!
  warnings.warn(
The tokenizer has new PAD/BOS/EOS tokens that differ from the model config and generation config. The model config and generation config were aligned accordingly, being updated with the tokenizer's values. Updated tokens: {'eos_token_id': 128009}.
既存のPEFTモデルを読み込み中: ../outputs/llama32-3b-typst-qlora-002-01/checkpoint-6
データセットを読み込み中...
データセットサイズ: 92
Llama 3.2 3B QLoRA学習を開始します...

  0%|          | 0/6 [00:00<?, ?it/s]
 17%|█▋        | 1/6 [00:22<01:53, 22.68s/it]
                                             

 17%|█▋        | 1/6 [00:22<01:53, 22.68s/it]
 33%|███▎      | 2/6 [01:40<03:39, 54.85s/it]
                                             

 33%|███▎      | 2/6 [01:40<03:39, 54.85s/it]
 50%|█████     | 3/6 [02:44<02:57, 59.25s/it]
                                             

 50%|█████     | 3/6 [02:44<02:57, 59.25s/it]
 67%|██████▋   | 4/6 [03:24<01:43, 51.50s/it]
                                             

 67%|██████▋   | 4/6 [03:24<01:43, 51.50s/it]
 83%|████████▎ | 5/6 [04:02<00:46, 46.66s/it]
                                             

 83%|████████▎ | 5/6 [04:02<00:46, 46.66s/it]
100%|██████████| 6/6 [04:27<00:00, 39.30s/it]
                                             

100%|██████████| 6/6 [04:27<00:00, 39.30s/it]
                                             

100%|██████████| 6/6 [04:30<00:00, 39.30s/it]
100%|██████████| 6/6 [04:30<00:00, 45.02s/it]
{'loss': 1.1445, 'grad_norm': 3.4740524291992188, 'learning_rate': 0.0, 'entropy': 1.3228435218334198, 'num_tokens': 1785.0, 'mean_token_accuracy': 0.8213856890797615, 'epoch': 0.17}
{'loss': 1.3829, 'grad_norm': 3.920985460281372, 'learning_rate': 1e-05, 'entropy': 1.4113129377365112, 'num_tokens': 3662.0, 'mean_token_accuracy': 0.7954532876610756, 'epoch': 0.35}
{'loss': 1.2584, 'grad_norm': 4.310050010681152, 'learning_rate': 2e-05, 'entropy': 1.4462528377771378, 'num_tokens': 5405.0, 'mean_token_accuracy': 0.8052178397774696, 'epoch': 0.52}
{'loss': 1.2502, 'grad_norm': 3.2699551582336426, 'learning_rate': 3e-05, 'entropy': 1.438593178987503, 'num_tokens': 7212.0, 'mean_token_accuracy': 0.8215744346380234, 'epoch': 0.7}
{'loss': 1.0302, 'grad_norm': 3.338728904724121, 'learning_rate': 4e-05, 'entropy': 1.4426934719085693, 'num_tokens': 9022.0, 'mean_token_accuracy': 0.8144252300262451, 'epoch': 0.87}
{'loss': 0.9893, 'grad_norm': 3.5919971466064453, 'learning_rate': 5e-05, 'entropy': 1.500624378522237, 'num_tokens': 10314.0, 'mean_token_accuracy': 0.8233117759227753, 'epoch': 1.0}
{'train_runtime': 270.1064, 'train_samples_per_second': 0.341, 'train_steps_per_second': 0.022, 'train_loss': 1.1758996148904164, 'epoch': 1.0}
モデルを保存中...
Llama 3.2 3B QLoRA学習完了！モデルは ../outputs/llama32-3b-typst-qlora-002-02 に保存されました。
