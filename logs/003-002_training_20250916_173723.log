Llama 3.2 3Bモデル: meta-llama/Llama-3.2-3B-Instruct
データ: ../jsonl/train_003.jsonl
出力: ../outputs/llama32-3b-typst-qlora-003-002
学習率: 1e-05
エポック数: 1
バッチサイズ: 1
勾配累積: 16
LoRA rank: 8
LoRA alpha: 8
LoRA dropout: 0.1
==================================================
トークナイザーを読み込み中...
4bit量子化設定を準備中...
モデルを読み込み中...

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.09s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  1.82s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.01s/it]
/mnt/d/github/typst-tex-converter/venv/lib/python3.11/site-packages/peft/tuners/lora/bnb.py:348: UserWarning: Merge lora module to 4-bit linear may get different generations due to rounding errors.
  warnings.warn(
/mnt/d/github/typst-tex-converter/venv/lib/python3.11/site-packages/peft/tuners/tuners_utils.py:196: UserWarning: Already found a `peft_config` attribute in the model. This will lead to having multiple adapters in the model. Make sure to know what you are doing!
  warnings.warn(
The tokenizer has new PAD/BOS/EOS tokens that differ from the model config and generation config. The model config and generation config were aligned accordingly, being updated with the tokenizer's values. Updated tokens: {'eos_token_id': 128009}.
既存のPEFTモデルを読み込み中: ../outputs/llama32-3b-typst-qlora-003-001
データセットを読み込み中...
データセットサイズ: 43
Llama 3.2 3B QLoRA学習を開始します...

  0%|          | 0/3 [00:00<?, ?it/s]
 33%|███▎      | 1/3 [00:13<00:27, 13.99s/it]
                                             

 33%|███▎      | 1/3 [00:13<00:27, 13.99s/it]
 67%|██████▋   | 2/3 [00:45<00:24, 24.42s/it]
                                             

 67%|██████▋   | 2/3 [00:45<00:24, 24.42s/it]
100%|██████████| 3/3 [01:00<00:00, 19.86s/it]
                                             

100%|██████████| 3/3 [01:00<00:00, 19.86s/it]
                                             

100%|██████████| 3/3 [01:02<00:00, 19.86s/it]
100%|██████████| 3/3 [01:02<00:00, 20.83s/it]
{'loss': 0.7289, 'grad_norm': 2.462263584136963, 'learning_rate': 0.0, 'entropy': 1.6585863195359707, 'num_tokens': 1932.0, 'mean_token_accuracy': 0.8163985572755337, 'epoch': 0.37}
{'loss': 0.5998, 'grad_norm': 2.1791906356811523, 'learning_rate': 1e-05, 'entropy': 1.328424397855997, 'num_tokens': 5033.0, 'mean_token_accuracy': 0.8601067401468754, 'epoch': 0.74}
{'loss': 0.9575, 'grad_norm': 2.9477953910827637, 'learning_rate': 5e-06, 'entropy': 1.5219464031132786, 'num_tokens': 6328.0, 'mean_token_accuracy': 0.8398954976688732, 'epoch': 1.0}
{'train_runtime': 62.4829, 'train_samples_per_second': 0.688, 'train_steps_per_second': 0.048, 'train_loss': 0.7620779871940613, 'epoch': 1.0}
モデルを保存中...
Llama 3.2 3B QLoRA学習完了！モデルは ../outputs/llama32-3b-typst-qlora-003-002 に保存されました。
